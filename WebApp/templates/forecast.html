<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7-Day Forecast for Station</title>
</head>
<body>
    <h1>7-Day Forecast for Station</h1>
    
    <!-- Form for user to select station and start date -->
    <form id="forecast-form">
        <label for="stationId">Select Station:</label>
        <select id="stationId">
            <option value="42">Station 42</option>
            <option value="43">Station 43</option>
            <option value="44">Station 44</option>
            <!-- Add more stations as needed -->
        </select>

        <br>

        <label for="startDate">Select Start Date:</label>
        <input type="date" id="startDate" value="2025-04-07" required>
        
        <br>

        <button type="submit">Get Forecast</button>
    </form>

    <h2>Forecast Results:</h2>
    <div id="forecast-results">
        <!-- Forecast data will be displayed here -->
    </div>

    <script>
        // Handle form submission
        document.getElementById("forecast-form").addEventListener("submit", async function(event) {
            event.preventDefault();

            // Get the selected station ID and start date
            const stationId = document.getElementById("stationId").value;
            const startDate = document.getElementById("startDate").value;

            // Prepare the payload to send to the backend API
            const payload = {
                station_id: stationId,
                start_date: startDate
            };

            try {
                // Fetch the forecast data from the backend
                const response = await fetch("/forecast", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();
                console.log(data);

                // Display forecast results
                const forecastResults = document.getElementById("forecast-results");
                forecastResults.innerHTML = "<ul>" +
                    data.forecast.map(day => `<li>${day}</li>`).join("") +
                    "</ul>";

            } catch (error) {
                console.error("Error fetching forecast data:", error);
                document.getElementById("forecast-results").innerText = "Error fetching forecast data.";
            }
        });
    </script>
</body>
</html>
